<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>004 Obtaining the Signed Certificate</title>
    <meta name="description" content="Suppose someone to assert: The gostak distims the doshes. You do not know what this means; nor do I. But if we assume that it is English, we know that the doshes are distimmed by the gostak. We know too that one distimmer of doshes is a gostak. If, moreover, the doshes are galloons, we know that some galloons are distimmed by the gostak. And so we may go on, and so we often do go on.
">

    <link rel="shortcut icon" href="/donakis/favicon.ico"/>
    <!--<link rel="stylesheet" href="/donakis/css/style.css">-->
    <!--<link rel="stylesheet" href="/donakis/css/collapse.css">-->
    <link rel="stylesheet" href="/donakis/css/main.css">
    <link rel="canonical" href="http://yourdomain.com/donakis/mailserver/startssl-crt/004-obtaining-the-certificate-signed-by-startssl.html">

    <!--<script src="/donakis/scripts/highlight.pack.js"></script>-->
    <script src="/donakis/scripts/modernizr.js"></script>



    <script>   
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        // My customisation
        if( location.hostname.match( 'maripac.github.io/donakis' ) ) {
          ga('create', 'UA-57199073-1', 'maripac.github.io/donakis/');
        }
        else {
          ga('create', 'UA-57069300-1', 'gostak.io/');
        }
        // My customisation END

        ga('send', 'pageview');
    </script>
<!--<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57069300-1', 'auto');
  ga('send', 'pageview');

</script>-->
<!--<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57199073-1', 'auto');
  ga('send', 'pageview');

</script>-->

</head>


  <body>

    <div id="outer-wrap">
      <div id="inner-wrap">


      <header class="site-header" id="top" role="banner">


  <div class="block">

    <div class="inner-header">
      <a class="site-header-inner" href="/donakis/">
      <h1>gostak.io</h1>
      <h6>when gostaks dream of electric doshes...</h6>
      </a>
    </div>
    
    <a class="nav-btn" id="nav-open-btn" href="#nav">Book Navigation</a>
  </div>


<!--<header class="site-header"> A-->

  

  <!--<div class="wrapper">

    <a class="site-title" href="/donakis/">gostak.io</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>


      <div class="trigger">
        
          
          <a class="page-link" href="/donakis/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/donakis/series/">Series</a>
          
        
          
        
      </div>

    </nav>

  </div>-->

<!--</header> A-->


</header>


<nav id="nav" role="navigation">
<div class="block">



<!--<div class="wrapper">-->

    

    <!--<nav class="site-nav">-->
      <!--<a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>-->


      <div class="trigger">
        <a class="page-link" href="/donakis/">home</a>
        
          
          <a class="page-link" href="/donakis/about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/donakis/series/">Series</a>
          
        
          
        
        <!--<a class="site-title page-link" href="/donakis/">gostak.io</a>-->
        
      </div>

    <!--</nav>-->

<!--</div>-->



<a class="close-btn" id="nav-close-btn" href="#top">Return to Content</a>
</div>
</nav>


        <div id="main" role="main">
          <article class="block prose">

            <div class="page-content">
              <div class="wrapper">
                <div class="post">
    <h2 class="in_series">004 Processing the Certificate Request</h2>

<ul class="post-list_aside">
 
    
        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/000-intro-and-resources.html"><span class="numbered">0</span> &mdash; Intro and resources</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/001-options-for-enabling-secure-connections-TLS.html"><span class="numbered">1</span> &mdash; Options for enabling TLS</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/002-creating-the-private-key-and-request-crs-locally.html"><span class="numbered">2</span> &mdash; Private key and certificate request</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/003-startssl-authentication-and-validation.html"><span class="numbered">3</span> &mdash; Authentication and Validation</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        

        <li class="active">
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="#"><span class="numbered">4</span> &mdash; Processing the Certificate Request</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/005-apache-virtual-host-on-secured-port.html"><span class="numbered">5</span> &mdash; Apache configuration</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
        
        
                <li>
            <!--<span class="post-meta">Nov 27, 2014</span>-->

            
              <a class="post-link-aside" href="/donakis/mailserver/startssl-crt/006-on-trusted-authorities-and-the-chain-of-trust.html"><span class="numbered">6</span> &mdash; On trusted Authorities</a>
              <!--<span class="post-meta">Nov 27, 2014</span>-->

            
        </li>
        

        


    
</ul>

  <article class="post-content">
    <p>Now it’s time to check for the availability of the certificate requests —the .csr files— that were previously generated in our local system. We are going to request two different certificates: one for www.mydomain.com, and another for the mail.mydomain.com. We should be able to retrieve each of those by typing the following commands from the terminal:</p>

<p>In the case of the mail.mydomain.com FQDN:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">mailserver</span><span class="p">.</span><span class="nx">csr</span></code></pre></div>

<p>In the case of the the www.mydomain.com FQDN:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">webserver</span><span class="p">.</span><span class="nx">csr</span></code></pre></div>

<p>Both should respond with a very long output of letters and numbers that must start and end as:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">BEGIN</span> <span class="nx">NEW</span> <span class="nx">CERTIFICATE</span> <span class="nx">REQUEST-----</span></code></pre></div>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">END</span> <span class="nx">NEW</span> <span class="nx">CERTIFICATE</span> <span class="nx">REQUEST-----</span></code></pre></div>

<p>So, as the previous output states what we have done so far is creating a public certificate request from a private key. Now we need to apply the formalization of this request to the StartCom Certification Authority, in order to satisfy this application with its corresponding Certificate file.</p>

<p>Navigate to the <a href="https://www.startssl.com/">StartSSL main page</a>, enter the control panel, and click on the Certificates tab. From the dropdown menu select the option as displayed below:</p>

<p><img src="/donakis/images/cert-wizard.png" alt="Certification Wizard" style="border:1px solid #003300;" /></p>

<p>Click to continue. Now skip the creation of any private keys, because we have already created them locally. At some point you will need to select from the validated list of Domain Names the correct one, and enter a subdomain (either www or mail). Next you must enter the certificate request that corresponds to the subdomain that you are currently applying to. This means that the csr that must be pasted when we request the Certificate for www.mydomain.com is the one that is outputed from the following command:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">webserver</span><span class="p">.</span><span class="nx">csr</span></code></pre></div>

<p>In the same way, when it comes to the creation of the Certificate that will be assigned to the subdomain mail.mydomain.com, we must remember to enter the output returned by running the following:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">mailserver</span><span class="p">.</span><span class="nx">csr</span></code></pre></div>

<p>Once the certificate request has been pasted and processed, you will be provided with the final Certificate. The code should start and end as the following:</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">BEGIN</span> <span class="nx">CERTIFICATE-----</span></code></pre></div>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">END</span> <span class="nx">CERTIFICATE-----</span></code></pre></div>

<p>Save them as /etc/ssl/certs/mailserver.pem and /etc/ssl/certs/webserver.pem. Their corresponding private keys will be in /etc/ssl/private/mailserver.pem and /etc/ssl/private/webserver.pem, respectively. You will need to copy to your local system the root certificate as well as the chain certificate file for each of these. The root certificate is commonly referenced as ca.pem while the chain certificate is by default named sub.class1.server.ca.pem. I suggest you copy them and then rename them to something like /etc/ssl/certs/mailca.pem and /etc/ssl/certs/sub.class1.mail.ca.pem, as well as /etc/ssl/certs/webca.pem and /etc/ssl/certs/sub.class1.web.ca.pem. </p>

<p>The last thing we have to do, involves removing the passphrases used for the encryption of the private keys. If you take a look at the output obtained by typing the cat command followed by the path to the private keys, as in: </p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">cat</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">private</span><span class="o">/</span><span class="nx">mailserver</span><span class="p">.</span><span class="nx">pem</span></code></pre></div>

<p>You will get an output similar to the one below. </p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">BEGIN</span> <span class="nx">RSA</span> <span class="nx">PRIVATE</span> <span class="nx">KEY-----</span>
<span class="nv">Proc-Type: </span><span class="mi">4</span><span class="p">,</span><span class="nx">ENCRYPTED</span></code></pre></div>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="o">-----</span><span class="nx">END</span> <span class="nx">RSA</span> <span class="nx">PRIVATE</span> <span class="nx">KEY-----</span></code></pre></div>

<p>As you’ll notice right after the initial definition line, there is a following line of text that identifies the following block of code as encrypted text. So before we upload those files to the live site, we should first decrypt its contents.</p>

<div class="highlight"><pre><code class="language-livescript" data-lang="livescript"><span class="nx">$</span> <span class="nx">mkdir</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">private</span>
<span class="nx">$</span> <span class="nx">openssl</span> <span class="nx">rsa</span> <span class="o">-</span><span class="k">in</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">private</span><span class="o">/</span><span class="nx">mailserver</span><span class="p">.</span><span class="nx">pem</span> <span class="o">-</span><span class="nx">out</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">private</span><span class="o">/</span><span class="nx">mailserver</span><span class="p">.</span><span class="nx">pem</span>
<span class="nx">$</span> <span class="nx">openssl</span> <span class="nx">rsa</span> <span class="o">-</span><span class="k">in</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">private</span><span class="o">/</span><span class="nx">webserver</span><span class="p">.</span><span class="nx">pem</span> <span class="o">-</span><span class="nx">out</span> <span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">ssl</span><span class="o">/</span><span class="nx">certs</span><span class="o">/</span><span class="nx">private</span><span class="o">/</span><span class="nx">webserver</span><span class="p">.</span><span class="nx">pem</span></code></pre></div>

<p>The second and third commands will prompt you for the passphrases needed to decrypt each of the files. Once entered your decrypted private keys will be stored at the specified destination. The first command just creates the destination folder inside the certs directory that will hold the final private keys that you will need to upload to the live server.</p>

  </article>


  
</div>

	<div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: THIS CODE IS ONLY AN EXAMPLE * * */
    var disqus_shortname = 'gostak'; // Required - Replace example with your forum shortname
    //var disqus_identifier = 'a unique identifier for each page where Disqus is present';
    //var disqus_title = 'a unique title for each page where Disqus is present';
    //var disqus_url = 'a unique URL for each page where Disqus is present';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>


              </div><!--//.wrapper-->
            </div><!--//.page-content-->

          </article><!--//.article-->
        </div> <!--//#main-->

      <footer class="site-footer">
    <div class="block">

  <div class="wrapper">

    <!--<h2 class="footer-heading">gostak.io</h2>-->

    <div class="footer-col-wrapper">
      
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><a class="site-footer-inner" href="/donakis/">gostak.io</a></li>
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/maripac">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">maripac</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Suppose someone to assert: The gostak distims the doshes. You do not know what this means; nor do I. But if we assume that it is English, we know that the doshes are distimmed by the gostak. We know too that one distimmer of doshes is a gostak. If, moreover, the doshes are galloons, we know that some galloons are distimmed by the gostak. And so we may go on, and so we often do go on.
</p>
      </div>
    </div>

  </div>
  

</footer>


      </div><!--//#inner-->
    </div><!--//#outer-->

    <script src="/donakis/scripts/jquery.min.js"></script>
    <!--// <script language="javascript" type="text/javascript">
    //   $(function() {
    //     if($('pre').length >0 ){
    //       hljs.initHighlightingOnLoad();
    //     }
    //   });
    // </script>-->
    <script src="/donakis/scripts/main.js"></script>
    



  </body>
</html>
